<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.2.1 (456793)"/><meta name="author" content="Mr.包子"/><meta name="created" content="2020-11-04 08:38:35 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2020-11-04 10:28:24 +0000"/><title>13-rollup和webpack比较</title></head><body><div><font face="Courier New" style="font-size: 18px;">rollup<span style="font-weight: bold; color: rgb(64, 73, 82); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">提供一个高效的 ES Modules 打包器，充分利用 ES Modules 的各项特性，构建出结构扁平，性能出众的类库</span><span style="color: rgb(64, 73, 82); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">。</span></font></div><div><font face="Courier New" style="font-size: 18px;"><span style="color: rgb(64, 73, 82); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></font></div><div style="orphans: 2; widows: 2; "><font color="#404952" face="Courier New"><span style="caret-color: rgb(64, 73, 82);">rollup 提供文件打包格式 es|amd|cjs|iife|umd|system</span></font></div><div style="orphans: 2; widows: 2; "><font color="#404952" face="Courier New"><span style="caret-color: rgb(64, 73, 82);">一般 amd|system 的浏览器兼容性比较好</span></font></div><div><span style="color: rgb(64, 73, 82); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><font face="Courier New" style="font-size: 18px;"><br/></font></span></div><div style="orphans: 2; widows: 2; "><font color="#404952" face="Courier New" style="font-size: 18px;"><span style="caret-color: rgb(64, 73, 82);">rollup只支持plugin这一种扩展模式</span></font></div><div><span style="color: rgb(64, 73, 82); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><font face="Courier New" style="font-size: 18px;"><br/></font></span></div><div><font face="Courier New" style="font-size: 18px;">rollup默认只支持ESModule加载模式，为了解决第三方包仍使用CommonJS加载模块，所以需要专门加载@rollup/plugin-commonjs。这样就可以了支持CommonJS导入和导出</font></div><div><font face="Courier New" style="font-size: 18px;"><br/></font></div><div><font face="Courier New" style="font-size: 18px;">Code Splitting 代码分割</font></div><div><font face="Courier New" style="font-size: 18px;">与webpack一样，可以使用符合ESModule标准的动态导入，实现按需加载。</font></div><div><font face="Courier New" style="font-size: 18px;">import(‘./logger’).then(({log})=&gt;{ log(‘code spliting~') })</font></div><div><font face="Courier New" style="font-size: 18px;">这时候需要注意的是配置文件中输出文件不能只能指明文件名称，只能指明文件夹</font></div><div><font face="Courier New">output:{</font></div><div><font face="Courier New"> // file : ‘dist/bundle.js' </font></div><div><font face="Courier New"><span>    dir : 'dist', // 分割后代码，输出的就是多个文件</span><br/></font></div><div><font face="Courier New"><span><span>    format : 'es'</span><br/></span></font></div><div><font face="Courier New">}</font></div><div><font face="Courier New">但是代码分割后的动态加载代码仍是import，即使使用system的模式，也需要加载Require.js来支持。</font></div><div><font face="Courier New"><br/></font></div><div><font face="Courier New">总结 rollup </font></div><div><font face="Courier New">优势</font></div><div><font face="Courier New">输出结果更加扁平，执行效率更高；</font></div><div><font face="Courier New">自动移除未引用代码；</font></div><div><font face="Courier New">打包结果依然完全可读；</font></div><div><font face="Courier New"><br/></font></div><div><font face="Courier New">缺点</font></div><div><font face="Courier New">加载非ESModule的第三方模块比较复杂，需要插件支持；</font></div><div><font face="Courier New">因为模块最终都被打包到全局中，无法实现HMR；</font></div><div><font face="Courier New">浏览器环境中，代码拆封功能必须使用Require.js这样的AMD库</font></div><div><font face="Courier New"><br/></font></div><div><font face="Courier New" style="font-size: 18px;"><br/></font></div><div><br/></div></body></html>