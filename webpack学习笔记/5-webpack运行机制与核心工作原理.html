<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.2.1 (456793)"/><meta name="author" content="Mr.包子"/><meta name="created" content="2020-11-03 15:43:42 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2020-11-04 10:27:34 +0000"/><title>5-webpack运行机制与核心工作原理</title></head><body><div>
<span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">1</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">、</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">Webpack CLI </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">启动打包流程；</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
2</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">、载入</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> Webpack </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">核心模块，创建</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> Compiler </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">对象；</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
3</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">、使用</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> Compiler </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">对象开始编译整个项目；</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
4</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">、从入口文件开始，解析模块依赖，形成依赖关系树；</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">递归依赖树，将每个模块交给对应的</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> Loader </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">处理；</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
5</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">、合并</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> Loader </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">处理完的结果，将打包结果输出到</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> dist </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">目录。</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">编译流程</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
1</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">、</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">SingleEntryPlugin </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">中调用了</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> Compilation </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">对象的</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> addEntry </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">方法，开始解析入口；</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
2</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">、</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">addEntry </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">方法中又调用了</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> _addModuleChain </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">方法，将入口模块添加到模块依赖列表中；</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
3</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">、紧接着通过</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> Compilation </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">对象的</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> buildModule </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">方法进行模块构建；</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
4</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">、</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">buildModule </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">方法中执行具体的</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> Loader</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">，处理特殊资源加载；</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
5</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">、</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">build </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">完成过后，通过</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> acorn </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">库生成模块代码的</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> AST </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">语法树；</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
6</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">、根据语法树分析这个模块是否还有依赖的模块，如果有则继续循环</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> build </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">每个依赖；</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
7</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">、所有依赖解析完成，</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">build </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">阶段结束；</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">最后合并生成需要输出的</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> bundle.js </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">写入</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> dist </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">目录。</span></div></body></html>