<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.2.1 (456793)"/><meta name="author" content="Mr.包子"/><meta name="created" content="2020-11-03 15:47:31 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2020-11-04 10:28:11 +0000"/><title>11-Code Splitting</title></head><body><div>
<span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">代码分割｜分块打包</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">拆分</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">bundle.js </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">，防止因为项目过大，一个</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">bundle</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">文件太大，导致页面加载缓慢。并有效实现按需加载，即项目启动不需要把所有的模块都加载进来，减少加载时长。</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">一、</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">webpack.config </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">配置多入口导入</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">(</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">传统项目代码经常使用</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">)</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
1</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">、指明多个入口文件</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
entry:{index:'./index.js',other:'other.js'}</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
tip</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">：注意这里的</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">entry</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">是一个对象，不是一个数组。如果是一个数组，那实际上还是打包到一个文件中，只是说明了需要从哪些文件开始分析。</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
2</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">、声明多个输出文件命名规则</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
output:{filename:"</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">[</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">name</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">]</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">.bundle.js"} // </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">[</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">name</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">]</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);" /><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">正则匹配入口文件中声明的对象</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
3</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">、利用</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">HtmlwebpackPlugin</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">生成多个</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">html</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">文件，并指明具体加载哪些输出文件</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
new HtmlwebpackPlugin({</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85); white-space: pre;"	/><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">fileName:'index.html;</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85); white-space: pre;"	/><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">chunks:</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">[</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">'index'</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">]</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> // </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">指明</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">html</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">中引入的</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">script</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">文件</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
}),</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
new HtmlwebpackPlugin({</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85); white-space: pre;"	/><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">fileName:'other.html',</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85); white-space: pre;"	/><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">chunks:</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">[</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">'other'</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">]</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"> // </span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">指明</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">html</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">中引入的</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">script</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">文件</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
}),</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">二、动态导入</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">利用</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">ESModule</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">的动态导入特性，将</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">import</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">静态导入放到代码中变为代码式的加载。因为</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">ESModule</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">会讲</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">import</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">语句变为一个</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">promise</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">，可以在</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">then</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">中进行具体对象的执行。</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">同时</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">webpack</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">支持根据</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">import</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">代码中添加注释命名</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">bundle</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">名称将动态导入的代码自动整合成一个</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">bundle</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">。若多个命名一致，也能自动整合在一起。</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">魔法注释</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">
import(/* webpackChunkName: 'posts' */'./posts/posts')</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">  .then(({ default: posts }) =&gt; {</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">    mainElement.appendChild(posts())</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">  })</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">最终会生成一个</span><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);">posts.bundle.js</span><span style="font: 14.0px 'PingFang SC'; color: rgba(0, 0, 0, 0.85);">的一个模块。</span></div><div><span style="font: 14.0px 'Helvetica Neue'; color: rgba(0, 0, 0, 0.85);"
/></div></body></html>